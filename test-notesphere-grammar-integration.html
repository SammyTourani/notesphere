<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîç NoteSphere Grammar Integration Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #1e293b;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .test-area {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-button {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 10px 5px;
        }
        .test-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }
        .results {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
            max-height: 400px;
            overflow-y: auto;
        }
        .error {
            background: #fef2f2;
            border: 1px solid #fca5a5;
            color: #dc2626;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }
        .success {
            background: #f0fdf4;
            border: 1px solid #86efac;
            color: #166534;
            padding: 12px;
            border-radius: 8px;
            margin: 8px 0;
        }
        .issue {
            background: white;
            border-left: 4px solid #ef4444;
            padding: 12px;
            margin: 8px 0;
            border-radius: 0 8px 8px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç NoteSphere Grammar Integration Test</h1>
        <p>Testing if the Ultimate Grammar System is properly integrated into NoteSphere</p>

        <div class="test-area">
            <h3>Test 1: Basic Import Test</h3>
            <p>Test if we can import and create the services</p>
            <button class="test-button" onclick="testImports()">Test Imports</button>
            <div id="importResults" class="results" style="display: none;"></div>
        </div>

        <div class="test-area">
            <h3>Test 2: Ultimate Grammar Service Direct Test</h3>
            <p>Test the Ultimate Grammar Service directly</p>
            <button class="test-button" onclick="testUltimateGrammarDirect()">Test Ultimate Grammar</button>
            <div id="ultimateResults" class="results" style="display: none;"></div>
        </div>

        <div class="test-area">
            <h3>Test 3: Advanced Grammar Service Test</h3>
            <p>Test the AdvancedGrammarService (what NoteSphere uses)</p>
            <button class="test-button" onclick="testAdvancedGrammarService()">Test Advanced Grammar</button>
            <div id="advancedResults" class="results" style="display: none;"></div>
        </div>

        <div class="test-area">
            <h3>Test 4: Error Text Analysis</h3>
            <p>Test with the exact text you entered in NoteSphere</p>
            <textarea id="testTextArea" style="width: 100%; height: 80px; padding: 12px; border: 1px solid #d1d5db; border-radius: 8px;">Between you and I, each of the students have finished there homework incorrectly. The data clearly shows that none of the participants was prepared for they're final exam. I could of helped them, but their going to have to learn this themself. Me and my colleague thinks that this are a serious problem that effects everyone.</textarea>
            <br>
            <button class="test-button" onclick="testCustomText()">Analyze Custom Text</button>
            <div id="customResults" class="results" style="display: none;"></div>
        </div>

        <div class="test-area">
            <h3>Test 5: Grammar Debug Test</h3>
            <p>Run the specialized debug functions</p>
            <button class="test-button" onclick="runDebugTests()">Run Debug Tests</button>
            <div id="debugResults" class="results" style="display: none;"></div>
        </div>
    </div>

    <script type="module">
        // Test 1: Basic Imports
        window.testImports = async function() {
            const container = document.getElementById('importResults');
            container.style.display = 'block';
            container.innerHTML = '<div>Testing imports...</div>';
            
            try {
                // Test if we can import the services
                const UltimateGrammarService = (await import('./src/services/UltimateGrammarService.js')).default;
                const AdvancedGrammarService = (await import('./src/services/AdvancedGrammarService.js')).default;
                
                container.innerHTML = `
                    <div class="success">‚úÖ Successfully imported UltimateGrammarService</div>
                    <div class="success">‚úÖ Successfully imported AdvancedGrammarService</div>
                    <div>Creating instances...</div>
                `;
                
                const ultimate = new UltimateGrammarService();
                const advanced = new AdvancedGrammarService();
                
                container.innerHTML += `
                    <div class="success">‚úÖ Successfully created UltimateGrammarService instance</div>
                    <div class="success">‚úÖ Successfully created AdvancedGrammarService instance</div>
                `;
                
            } catch (error) {
                container.innerHTML = `<div class="error">‚ùå Import failed: ${error.message}</div>`;
                console.error('Import test failed:', error);
            }
        };

        // Test 2: Ultimate Grammar Service Direct
        window.testUltimateGrammarDirect = async function() {
            const container = document.getElementById('ultimateResults');
            container.style.display = 'block';
            container.innerHTML = '<div>Testing Ultimate Grammar Service...</div>';
            
            try {
                const UltimateGrammarService = (await import('./src/services/UltimateGrammarService.js')).default;
                const ultimate = new UltimateGrammarService();
                
                const testText = "Between you and I, each of the students have finished there homework.";
                
                const result = await ultimate.checkText(testText);
                
                container.innerHTML = `
                    <div class="success">‚úÖ Ultimate Grammar Service worked!</div>
                    <div><strong>Issues found:</strong> ${result.issues ? result.issues.length : 0}</div>
                    <div><strong>Processing time:</strong> ${result.statistics?.processingTime || 'N/A'}ms</div>
                `;
                
                if (result.issues && result.issues.length > 0) {
                    container.innerHTML += '<div><strong>Issues:</strong></div>';
                    result.issues.forEach((issue, index) => {
                        container.innerHTML += `
                            <div class="issue">
                                <strong>${index + 1}.</strong> ${issue.message} 
                                <br><small>Category: ${issue.category}, Engine: ${issue.engine}</small>
                            </div>
                        `;
                    });
                } else {
                    container.innerHTML += '<div class="error">‚ö†Ô∏è No issues detected - this suggests a problem!</div>';
                }
                
            } catch (error) {
                container.innerHTML = `<div class="error">‚ùå Ultimate Grammar test failed: ${error.message}</div>`;
                console.error('Ultimate Grammar test failed:', error);
            }
        };

        // Test 3: Advanced Grammar Service
        window.testAdvancedGrammarService = async function() {
            const container = document.getElementById('advancedResults');
            container.style.display = 'block';
            container.innerHTML = '<div>Testing AdvancedGrammarService...</div>';
            
            try {
                const AdvancedGrammarService = (await import('./src/services/AdvancedGrammarService.js')).default;
                const advancedGrammarService = new AdvancedGrammarService();
                
                const testText = "Between you and I, each of the students have finished there homework.";
                
                const result = await advancedGrammarService.checkText(testText);
                
                container.innerHTML = `
                    <div class="success">‚úÖ AdvancedGrammarService worked!</div>
                    <div><strong>Issues found:</strong> ${result.issues ? result.issues.length : 0}</div>
                    <div><strong>Processing time:</strong> ${result.statistics?.processingTime || 'N/A'}ms</div>
                `;
                
                if (result.issues && result.issues.length > 0) {
                    container.innerHTML += '<div><strong>Issues:</strong></div>';
                    result.issues.forEach((issue, index) => {
                        container.innerHTML += `
                            <div class="issue">
                                <strong>${index + 1}.</strong> ${issue.message} 
                                <br><small>Category: ${issue.category}, Engine: ${issue.engine}</small>
                            </div>
                        `;
                    });
                } else {
                    container.innerHTML += '<div class="error">‚ö†Ô∏è No issues detected - this suggests a problem!</div>';
                }
                
            } catch (error) {
                container.innerHTML = `<div class="error">‚ùå AdvancedGrammarService test failed: ${error.message}</div>`;
                console.error('AdvancedGrammarService test failed:', error);
            }
        };

        // Test 4: Custom Text
        window.testCustomText = async function() {
            const container = document.getElementById('customResults');
            const textArea = document.getElementById('testTextArea');
            
            container.style.display = 'block';
            container.innerHTML = '<div>Analyzing custom text...</div>';
            
            try {
                const AdvancedGrammarService = (await import('./src/services/AdvancedGrammarService.js')).default;
                const advancedGrammarService = new AdvancedGrammarService();
                
                const testText = textArea.value;
                const result = await advancedGrammarService.checkText(testText);
                
                container.innerHTML = `
                    <div class="success">‚úÖ Analysis complete!</div>
                    <div><strong>Text length:</strong> ${testText.length} characters</div>
                    <div><strong>Issues found:</strong> ${result.issues ? result.issues.length : 0}</div>
                    <div><strong>Processing time:</strong> ${result.statistics?.processingTime || 'N/A'}ms</div>
                    <div><strong>Quality score:</strong> ${result.statistics?.qualityScore || 'N/A'}</div>
                `;
                
                if (result.issues && result.issues.length > 0) {
                    container.innerHTML += '<div><strong>Detailed Issues:</strong></div>';
                    result.issues.forEach((issue, index) => {
                        container.innerHTML += `
                            <div class="issue">
                                <strong>${index + 1}.</strong> ${issue.message} 
                                <br><small>Category: ${issue.category}, Severity: ${issue.severity}, Confidence: ${issue.confidence || 'N/A'}</small>
                                ${issue.suggestions ? `<br><small>Suggestions: ${issue.suggestions.join(', ')}</small>` : ''}
                            </div>
                        `;
                    });
                } else {
                    container.innerHTML += '<div class="error">‚ö†Ô∏è No issues detected - this is unexpected for this text!</div>';
                }
                
            } catch (error) {
                container.innerHTML = `<div class="error">‚ùå Custom text analysis failed: ${error.message}</div>`;
                console.error('Custom text analysis failed:', error);
            }
        };

        // Test 5: Debug Functions
        window.runDebugTests = async function() {
            const container = document.getElementById('debugResults');
            container.style.display = 'block';
            container.innerHTML = '<div>Running debug tests...</div>';
            
            try {
                const { runAllGrammarTests } = await import('./src/services/TestGrammarDebug.js');
                
                // Capture console output
                const originalLog = console.log;
                const logs = [];
                console.log = (...args) => {
                    logs.push(args.join(' '));
                    originalLog(...args);
                };
                
                await runAllGrammarTests();
                
                // Restore console
                console.log = originalLog;
                
                container.innerHTML = `
                    <div class="success">‚úÖ Debug tests completed!</div>
                    <div><strong>Console output:</strong></div>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 12px; border-radius: 8px; overflow-x: auto;">${logs.join('\n')}</pre>
                `;
                
            } catch (error) {
                container.innerHTML = `<div class="error">‚ùå Debug tests failed: ${error.message}</div>`;
                console.error('Debug tests failed:', error);
            }
        };

        console.log('üîç NoteSphere Grammar Integration Test loaded');
    </script>
</body>
</html> 